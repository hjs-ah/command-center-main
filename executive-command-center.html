<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Command Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-card: #252525;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --accent-primary: #3b82f6;
            --accent-secondary: #8b5cf6;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-danger: #ef4444;
            --border-color: #333333;
        }

        body.light-mode {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-card: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .date-display {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-toggle, .export-btn {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover, .export-btn:hover {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .domain-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .domain-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
        }

        .domain-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .domain-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .domain-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-success);
        }

        .status-planning {
            background: rgba(245, 158, 11, 0.2);
            color: var(--accent-warning);
        }

        .domain-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .progress-section {
            margin-bottom: 20px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .progress-bar {
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transition: width 0.3s ease;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-item {
            text-align: center;
            padding: 10px;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        .metric-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .metric-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--accent-primary);
        }

        .action-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-link {
            flex: 1;
            min-width: 120px;
            padding: 10px 15px;
            background: var(--accent-primary);
            color: white;
            text-align: center;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .action-link:hover {
            background: var(--accent-secondary);
            transform: translateY(-2px);
        }

        .review-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 40px;
        }

        .review-header {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .review-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .review-item {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--accent-primary);
        }

        .review-item h3 {
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .checklist {
            list-style: none;
        }

        .checklist li {
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checklist li:last-child {
            border-bottom: none;
        }

        .checklist input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .header-controls {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>Antone's ExecCC Assist</h1>
                <div class="date-display" id="currentDate"></div>
            </div>
            <div class="header-controls">
                <button class="theme-toggle" onclick="toggleTheme()">‚òÄÔ∏è Light Mode</button>
                <button class="export-btn" onclick="exportData()">üìä Export</button>
                <button class="export-btn" onclick="printDashboard()">üñ®Ô∏è Print</button>
            </div>
        </header>

        <!-- Navigation Links -->
        <div style="display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap;">
            <a href="strategy-deployment-matrix.html" style="background: var(--accent-primary); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">Strategy Matrix</a>
            <a href="raci-matrix.html" style="background: var(--accent-primary); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">RACI Matrix</a>
            <a href="logic-model.html" style="background: var(--accent-primary); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">Logic Model</a>
            <a href="stakeholder-map.html" style="background: var(--accent-primary); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">Stakeholder Map</a>
            <a href="90day-action-cascade.html" style="background: var(--accent-primary); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">90-Day Cascade</a>
            <a href="time-architecture.html" style="background: var(--accent-primary); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">Time Architecture</a>
            <a href="eisenhower-matrix.html" style="background: var(--accent-secondary); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">Eisenhower Matrix</a>
        </div>

        <!-- Quick Stats Overview -->
        <div class="quick-stats">
            <div class="stat-card">
                <div class="stat-number" id="activeMilestonesBuilders">0</div>
                <div class="stat-label">Builder's Conference Active Milestones</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeMilestonesProfessional">0</div>
                <div class="stat-label">Professional Active Milestones</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeMilestonesChess">0</div>
                <div class="stat-label">Chess Not Checkers Active Milestones</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="daysToQ1End">89</div>
                <div class="stat-label">Days to Q1 End</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="weeklyReviews" style="color: var(--accent-success);">0</div>
                <div class="stat-label">Weekly Reviews Completed</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="missedReviews" style="color: var(--accent-danger);">0</div>
                <div class="stat-label">Missed Weekly Reviews</div>
            </div>
        </div>

        <!-- Priority Domains Dashboard -->
        <div class="dashboard-grid">
            <!-- Builder's Conference Card -->
            <div class="domain-card">
                <div class="domain-header">
                    <div class="domain-title">Builder's Conference</div>
                    <div class="domain-status status-active">Active</div>
                </div>
                <div style="font-style: italic; color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 5px;">
                    Scope: Doctoral/Ministry Domain
                </div>
                <div class="domain-description">
                    Economic empowerment ecosystem launch - Q1 2026 target
                </div>
                <div class="progress-section">
                    <div class="progress-label">
                        <span>Overall Progress</span>
                        <span id="bc-progress-text">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="bc-progress" style="width: 0%"></div>
                    </div>
                </div>
                
                <div style="background: var(--bg-secondary); padding: 12px; border-radius: 6px; margin: 15px 0; font-size: 0.85rem;">
                    <div style="font-weight: 600; margin-bottom: 8px;">üìä Strategy & Execution Summary</div>
                    <div id="bc-strategy-summary" style="color: var(--text-secondary); line-height: 1.5;">
                        ‚Ä¢ Strategy: <span id="bc-csf-summary">0 critical success factors</span><br>
                        ‚Ä¢ RACI: <span id="bc-raci-summary">0 tasks assigned</span><br>
                        ‚Ä¢ Logic Model: <span id="bc-logic-summary">0 inputs/activities defined</span>
                    </div>
                </div>

                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-label">Milestones</div>
                        <div class="metric-value" id="bc-milestones">0/12</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">Partnerships</div>
                        <div class="metric-value" id="bc-partnerships">0</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">Team Members</div>
                        <div class="metric-value" id="bc-team">0</div>
                    </div>
                </div>
                <div class="action-links">
                    <a href="strategy-deployment-matrix.html#builders" class="action-link">Strategy Matrix</a>
                    <a href="raci-matrix.html#builders" class="action-link">RACI Matrix</a>
                    <a href="logic-model.html#builders" class="action-link">Logic Model</a>
                </div>
            </div>

            <!-- Professional/Career Card -->
            <div class="domain-card">
                <div class="domain-header">
                    <div class="domain-title">Professional/Career</div>
                    <div class="domain-status status-active">Active</div>
                </div>
                <div style="font-style: italic; color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 5px;">
                    Scope: Professional Domain
                </div>
                <div class="domain-description">
                    Q1 partnership excellence + high-performance culture + 2025 strategy
                </div>
                <div class="progress-section">
                    <div class="progress-label">
                        <span>Overall Progress</span>
                        <span id="prof-progress-text">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="prof-progress" style="width: 0%"></div>
                    </div>
                </div>

                <div style="background: var(--bg-secondary); padding: 12px; border-radius: 6px; margin: 15px 0; font-size: 0.85rem;">
                    <div style="font-weight: 600; margin-bottom: 8px;">üìä Strategy & Execution Summary</div>
                    <div id="prof-strategy-summary" style="color: var(--text-secondary); line-height: 1.5;">
                        ‚Ä¢ Strategy: <span id="prof-csf-summary">0 critical success factors</span><br>
                        ‚Ä¢ RACI: <span id="prof-raci-summary">0 tasks assigned</span><br>
                        ‚Ä¢ Stakeholder Map: <span id="prof-stakeholder-summary">0 stakeholders mapped</span>
                    </div>
                </div>

                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-label">Q1 Goals</div>
                        <div class="metric-value" id="prof-goals">0/8</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">Team Alignment</div>
                        <div class="metric-value" id="prof-alignment">0%</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">Strategy Docs</div>
                        <div class="metric-value" id="prof-docs">0</div>
                    </div>
                </div>
                <div class="action-links">
                    <a href="strategy-deployment-matrix.html#professional" class="action-link">Strategy Matrix</a>
                    <a href="raci-matrix.html#professional" class="action-link">RACI Matrix</a>
                    <a href="stakeholder-map.html#professional" class="action-link">Stakeholder Map</a>
                </div>
            </div>

            <!-- Chess Not Checkers Card -->
            <div class="domain-card">
                <div class="domain-header">
                    <div class="domain-title">Chess Not Checkers</div>
                    <div class="domain-status status-planning">Planning</div>
                </div>
                <div style="font-style: italic; color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 5px;">
                    Scope: Ministry/Youth Development Domain
                </div>
                <div class="domain-description">
                    Executive mindset framework + strategic exposure + 2026 expansion
                </div>
                <div class="progress-section">
                    <div class="progress-label">
                        <span>Overall Progress</span>
                        <span id="cnc-progress-text">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="cnc-progress" style="width: 0%"></div>
                    </div>
                </div>

                <div style="background: var(--bg-secondary); padding: 12px; border-radius: 6px; margin: 15px 0; font-size: 0.85rem;">
                    <div style="font-weight: 600; margin-bottom: 8px;">üìä Strategy & Execution Summary</div>
                    <div id="cnc-strategy-summary" style="color: var(--text-secondary); line-height: 1.5;">
                        ‚Ä¢ Strategy: <span id="cnc-csf-summary">0 critical success factors</span><br>
                        ‚Ä¢ RACI: <span id="cnc-raci-summary">0 tasks assigned</span><br>
                        ‚Ä¢ Logic Model: <span id="cnc-logic-summary">0 inputs/activities defined</span>
                    </div>
                </div>

                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-label">Participants</div>
                        <div class="metric-value" id="cnc-participants">0</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">Mentors</div>
                        <div class="metric-value" id="cnc-mentors">0</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">Framework %</div>
                        <div class="metric-value" id="cnc-framework">0%</div>
                    </div>
                </div>
                <div class="action-links">
                    <a href="strategy-deployment-matrix.html#chess" class="action-link">Strategy Matrix</a>
                    <a href="raci-matrix.html#chess" class="action-link">RACI Matrix</a>
                    <a href="logic-model.html#chess" class="action-link">Logic Model</a>
                </div>
            </div>
        </div>

        <!-- Weekly Review Section -->
        <div class="review-section">
            <div class="review-header">‚ö° Weekly Review Checklist</div>
            <div style="margin-bottom: 15px; padding: 10px; background: var(--bg-secondary); border-radius: 6px;">
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                    <input type="checkbox" id="priorWeekComplete" style="width: 20px; height: 20px;">
                    <span style="font-weight: 600;">Prior week's review completed</span>
                </label>
            </div>
            <div class="review-grid">
                <div class="review-item">
                    <h3>Strategic Review</h3>
                    <ul class="checklist">
                        <li><input type="checkbox" id="review-1"> Review progress on all 3 domains</li>
                        <li><input type="checkbox" id="review-2"> Update milestone completion status</li>
                        <li><input type="checkbox" id="review-3"> Identify blockers and dependencies</li>
                        <li><input type="checkbox" id="review-4"> Adjust 90-day action plan if needed</li>
                    </ul>
                </div>
                <div class="review-item">
                    <h3>Stakeholder Engagement</h3>
                    <ul class="checklist">
                        <li><input type="checkbox" id="review-5"> Key conversations completed</li>
                        <li><input type="checkbox" id="review-6"> Partnership progress tracked</li>
                        <li><input type="checkbox" id="review-7"> Team accountability check-ins</li>
                        <li><input type="checkbox" id="review-8"> Pre-wire next week's decisions</li>
                    </ul>
                </div>
                <div class="review-item">
                    <h3>Time Architecture</h3>
                    <ul class="checklist">
                        <li><input type="checkbox" id="review-9"> Deep work sessions protected</li>
                        <li><input type="checkbox" id="review-10"> Calendar aligned with priorities</li>
                        <li><input type="checkbox" id="review-11"> Energy management optimized</li>
                        <li><input type="checkbox" id="review-12"> Next week's focus areas defined</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize data storage
        const STORAGE_KEY = 'executive_command_center';

        function loadData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            return saved ? JSON.parse(saved) : {
                buildersConference: {
                    progress: 0,
                    milestones: { completed: 0, total: 12 },
                    partnerships: 0,
                    team: 0
                },
                professional: {
                    progress: 0,
                    goals: { completed: 0, total: 8 },
                    alignment: 0,
                    docs: 0
                },
                chessNotCheckers: {
                    progress: 0,
                    participants: 0,
                    mentors: 0,
                    framework: 0
                },
                weeklyReviews: 0,
                missedReviews: 0,
                lastReviewDate: null,
                weekNumber: 1
            };
        }

        function saveData(data) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        function loadExternalData(key) {
            const saved = localStorage.getItem(key);
            return saved ? JSON.parse(saved) : null;
        }

        function updateDisplay() {
            const data = loadData();

            // Builder's Conference
            document.getElementById('bc-progress').style.width = data.buildersConference.progress + '%';
            document.getElementById('bc-progress-text').textContent = data.buildersConference.progress + '%';
            document.getElementById('bc-milestones').textContent = 
                `${data.buildersConference.milestones.completed}/${data.buildersConference.milestones.total}`;
            document.getElementById('bc-partnerships').textContent = data.buildersConference.partnerships;
            document.getElementById('bc-team').textContent = data.buildersConference.team;

            // Professional
            document.getElementById('prof-progress').style.width = data.professional.progress + '%';
            document.getElementById('prof-progress-text').textContent = data.professional.progress + '%';
            document.getElementById('prof-goals').textContent = 
                `${data.professional.goals.completed}/${data.professional.goals.total}`;
            document.getElementById('prof-alignment').textContent = data.professional.alignment + '%';
            document.getElementById('prof-docs').textContent = data.professional.docs;

            // Chess Not Checkers
            document.getElementById('cnc-progress').style.width = data.chessNotCheckers.progress + '%';
            document.getElementById('cnc-progress-text').textContent = data.chessNotCheckers.progress + '%';
            document.getElementById('cnc-participants').textContent = data.chessNotCheckers.participants;
            document.getElementById('cnc-mentors').textContent = data.chessNotCheckers.mentors;
            document.getElementById('cnc-framework').textContent = data.chessNotCheckers.framework + '%';

            // Load and display summaries from other tools
            updateSummaries();

            // Days to Q1 End (March 31, 2026)
            const q1End = new Date('2026-03-31');
            const today = new Date();
            const daysLeft = Math.ceil((q1End - today) / (1000 * 60 * 60 * 24));
            document.getElementById('daysToQ1End').textContent = daysLeft;

            // Weekly reviews with color coding
            const reviewsEl = document.getElementById('weeklyReviews');
            reviewsEl.textContent = data.weeklyReviews;
            reviewsEl.style.color = data.missedReviews > 0 ? 'var(--accent-danger)' : 'var(--accent-success)';
            
            document.getElementById('missedReviews').textContent = data.missedReviews;
        }

        function updateSummaries() {
            // Strategy Deployment Matrix summaries
            const strategyData = loadExternalData('strategy_deployment_matrix');
            if (strategyData) {
                // Builders
                const bcCSF = strategyData.builders.csf.length;
                document.getElementById('bc-csf-summary').textContent = `${bcCSF} critical success factors`;
                const bcActiveMilestones = strategyData.builders.milestones.filter(m => !m.completed).length;
                document.getElementById('activeMilestonesBuilders').textContent = bcActiveMilestones;

                // Professional
                const profCSF = strategyData.professional.csf.length;
                document.getElementById('prof-csf-summary').textContent = `${profCSF} critical success factors`;
                const profActiveMilestones = strategyData.professional.milestones.filter(m => !m.completed).length;
                document.getElementById('activeMilestonesProfessional').textContent = profActiveMilestones;

                // Chess
                const cncCSF = strategyData.chess.csf.length;
                document.getElementById('cnc-csf-summary').textContent = `${cncCSF} critical success factors`;
                const cncActiveMilestones = strategyData.chess.milestones.filter(m => !m.completed).length;
                document.getElementById('activeMilestonesChess').textContent = cncActiveMilestones;
            }

            // RACI Matrix summaries
            const raciData = loadExternalData('raci_matrix');
            if (raciData) {
                const bcTasks = raciData.builders.tasks.length;
                document.getElementById('bc-raci-summary').textContent = `${bcTasks} tasks assigned`;
                
                const profTasks = raciData.professional.tasks.length;
                document.getElementById('prof-raci-summary').textContent = `${profTasks} tasks assigned`;
                
                const cncTasks = raciData.chess.tasks.length;
                document.getElementById('cnc-raci-summary').textContent = `${cncTasks} tasks assigned`;
            }

            // Logic Model summaries
            const logicData = loadExternalData('logic_model');
            if (logicData) {
                const bcInputs = logicData.builders.inputs.length;
                const bcActivities = logicData.builders.activities.length;
                document.getElementById('bc-logic-summary').textContent = 
                    `${bcInputs} inputs, ${bcActivities} activities`;
                
                const cncInputs = logicData.chess.inputs.length;
                const cncActivities = logicData.chess.activities.length;
                document.getElementById('cnc-logic-summary').textContent = 
                    `${cncInputs} inputs, ${cncActivities} activities`;
            }

            // Stakeholder Map summary
            const stakeholderData = loadExternalData('stakeholder_map');
            if (stakeholderData) {
                const profStakeholders = stakeholderData.professional.formal.length + 
                                        stakeholderData.professional.informal.length +
                                        stakeholderData.professional.resources.length +
                                        stakeholderData.professional.blockers.length;
                document.getElementById('prof-stakeholder-summary').textContent = 
                    `${profStakeholders} stakeholders mapped`;
            }
        }

        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const btn = document.querySelector('.theme-toggle');
            btn.textContent = document.body.classList.contains('light-mode') ? 'üåô Dark Mode' : '‚òÄÔ∏è Light Mode';
            localStorage.setItem('theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
        }

        function exportData() {
            const data = loadData();
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `execcc-dashboard-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            alert('üìä Export Data Info:\n\nThis exports your dashboard data as JSON backup.\n\nUse cases:\n‚Ä¢ Backup before major changes\n‚Ä¢ Transfer data between devices\n‚Ä¢ Archive quarterly snapshots\n‚Ä¢ Data recovery if needed');
        }

        function printDashboard() {
            window.print();
        }

        // Initialize date display
        function updateDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = 
                new Date().toLocaleDateString('en-US', options);
        }

        // Check if new week has started and update missed reviews
        function checkWeekTransition() {
            const data = loadData();
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday
            
            // If it's Monday and prior week review wasn't completed
            if (dayOfWeek === 1) {
                const priorWeekCheckbox = document.getElementById('priorWeekComplete');
                if (!priorWeekCheckbox.checked) {
                    data.missedReviews++;
                    saveData(data);
                    updateDisplay();
                }
            }
        }

        // Track weekly review completion
        document.querySelectorAll('.checklist input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const allChecked = Array.from(document.querySelectorAll('.checklist input[type="checkbox"]'))
                    .every(cb => cb.checked);
                
                if (allChecked) {
                    const data = loadData();
                    data.weeklyReviews++;
                    data.lastReviewDate = new Date().toISOString();
                    saveData(data);
                    updateDisplay();
                    
                    // Reset checkboxes for next week
                    document.querySelectorAll('.checklist input[type="checkbox"]').forEach(cb => cb.checked = false);
                    
                    alert('üéâ Weekly review completed! Great work staying on top of your strategic priorities.');
                }
            });
        });

        // Prior week completion tracker
        document.getElementById('priorWeekComplete').addEventListener('change', function() {
            const data = loadData();
            if (this.checked) {
                // Mark prior week as complete - don't count as missed
            } else {
                // If unchecking, might indicate missed review
            }
            saveData(data);
        });

        // Initialize on load
        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                document.querySelector('.theme-toggle').textContent = 'üåô Dark Mode';
            }
            updateDate();
            updateDisplay();
            checkWeekTransition();
            
            // Refresh summaries every 5 seconds if page is active
            setInterval(() => {
                if (document.visibilityState === 'visible') {
                    updateSummaries();
                }
            }, 5000);
        });
    </script>
</body>
</html>
