<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stakeholder Influence Map | Executive Command Center</title>
    <style>
        :root {
            --bg-page: #ffffff; --bg-card: #f8f9fa; --text-primary: #1a1a1a;
            --text-secondary: #4a4a4a; --text-muted: #7a7a7a; --accent-color: #ffe000;
            --border-color: #e5e5e5; --shadow: rgba(0, 0, 0, 0.05);
        }
        [data-theme="dark"] {
            --bg-page: #0a0a0a; --bg-card: #1a1a1a; --text-primary: #f0f0f0;
            --text-secondary: #b0b0b0; --text-muted: #808080; --border-color: #2a2a2a;
            --shadow: rgba(255, 255, 255, 0.05);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-page); color: var(--text-primary); line-height: 1.6;
            padding: 40px 20px; transition: all 0.3s ease;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 40px; padding-bottom: 20px; border-bottom: 1px solid var(--border-color); }
        h1 { font-size: 28px; font-weight: 700; }
        .subtitle { font-size: 11px; color: var(--text-muted); margin-top: 4px; font-style: italic; }
        .controls { display: flex; gap: 12px; }
        .btn {
            background: var(--bg-card); border: 1px solid var(--border-color);
            padding: 8px 16px; border-radius: 6px; font-size: 12px; font-weight: 500;
            color: var(--text-secondary); cursor: pointer; transition: all 0.2s ease; text-decoration: none;
        }
        .btn:hover { background: var(--bg-page); color: var(--text-primary);
            border-color: var(--text-muted); transform: translateY(-1px); }
        
        /* Domain Tabs */
        .domain-tabs {
            display: flex; gap: 8px; margin-bottom: 32px; flex-wrap: wrap;
        }
        .domain-tab {
            padding: 10px 20px; background: transparent;
            border: 1px solid var(--border-color); border-radius: 6px;
            cursor: pointer; font-size: 13px; font-weight: 600;
            color: var(--text-secondary); transition: all 0.2s ease;
        }
        .domain-tab:hover { background: var(--bg-card); }
        .domain-tab.active {
            background: var(--accent-color); color: #1a1a1a; border-color: var(--accent-color);
        }
        .domain-content { display: none; }
        .domain-content.active { display: block; }
        
        /* Statistics Overview */
        .stats-overview {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
        }
        .stats-overview h2 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--text-primary);
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
        }
        .stat-card {
            text-align: center;
            padding: 16px;
            background: var(--bg-page);
            border: 1px solid var(--border-color);
            border-radius: 6px;
        }
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        .stat-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }
        .stat-q1 { color: #ef4444; }
        .stat-q2 { color: #f59e0b; }
        .stat-q3 { color: #3b82f6; }
        .stat-q4 { color: #10b981; }
        .stat-total { color: var(--accent-color); }
        
        .power-interest-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-top: 30px; min-height: 600px;
        }
        .quadrant {
            background: var(--bg-card); border: 2px solid var(--border-color);
            border-radius: 8px; padding: 20px; position: relative;
        }
        .quadrant-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }
        .quadrant-title {
            font-size: 14px; font-weight: 700;
        }
        .quadrant-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .formal-authority { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .informal-influence { background: rgba(139, 92, 246, 0.2); color: #8b5cf6; }
        .resource-control { background: rgba(16, 185, 129, 0.2); color: #10b981; }
        .blockers { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .quadrant-description {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 16px;
            font-style: italic;
        }
        .stakeholder-list { display: flex; flex-direction: column; gap: 8px; }
        .stakeholder {
            background: var(--bg-page); border: 1px solid var(--border-color);
            border-radius: 4px; padding: 12px; font-size: 12px;
        }
        .stakeholder input {
            width: 100%; background: transparent; border: none; color: var(--text-primary);
            outline: none; margin-bottom: 4px; font-size: 12px; font-weight: 600;
        }
        .stakeholder textarea {
            width: 100%; background: transparent; border: none; color: var(--text-secondary);
            outline: none; font-size: 11px; resize: none; font-family: inherit; min-height: 30px;
        }
        .add-stakeholder {
            width: 100%; padding: 10px; margin-top: 8px; background: transparent;
            border: 2px dashed var(--border-color); border-radius: 4px;
            color: var(--text-muted); cursor: pointer; font-size: 11px; font-weight: 600;
        }
        .add-stakeholder:hover { border-color: var(--accent-color); color: var(--accent-color); }
        
        /* 30-60-90 Day Strategy Section */
        .strategy-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 24px;
            margin-top: 24px;
        }
        .strategy-section h3 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--text-primary);
        }
        .timeline-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }
        .timeline-column {
            background: var(--bg-page);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 16px;
        }
        .timeline-header {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--accent-color);
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }
        .action-item {
            background: var(--bg-card);
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin-bottom: 8px;
            font-size: 11px;
            display: flex;
            align-items: start;
            gap: 8px;
        }
        .action-item input[type="checkbox"] {
            margin-top: 2px;
            cursor: pointer;
        }
        .action-item textarea {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 11px;
            resize: none;
            outline: none;
            font-family: inherit;
            min-height: 40px;
        }
        .action-item button {
            padding: 2px 6px;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            font-size: 9px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        .action-item button:hover {
            background: #ef4444;
            border-color: #ef4444;
            color: white;
        }
        
        .high-power-high-interest { border-color: #ef4444; }
        .high-power-low-interest { border-color: #f59e0b; }
        .low-power-high-interest { border-color: #3b82f6; }
        .low-power-low-interest { border-color: #10b981; }
        @media (max-width: 768px) { .power-interest-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>Stakeholder Influence Map</h1>
                <p class="subtitle">Power-Interest Grid</p>
            </div>
            <div class="controls">
                <button class="btn" onclick="toggleTheme()">üåô Dark Mode</button>
                <button class="btn" onclick="exportData()">üìä Export</button>
                <a href="index.html" class="btn">‚Üê Dashboard</a>
            </div>
        </header>

        <!-- Domain Tabs -->
        <div class="domain-tabs" id="domainTabs">
            <button class="domain-tab active" onclick="switchDomain('builders')">Builder's Conference</button>
            <button class="domain-tab" onclick="switchDomain('professional')">Professional/Career</button>
            <button class="domain-tab" onclick="switchDomain('chess')">Chess Not Checkers</button>
        </div>

        <!-- Domain Contents Container -->
        <div id="domainContents"></div>
    </div>

    <script>
        let currentDomain = 'builders';
        let data = {};
        let domains = [
            { id: 'builders', name: "Builder's Conference" },
            { id: 'professional', name: 'Professional/Career' },
            { id: 'chess', name: 'Chess Not Checkers' }
        ];
        let counter = 0;

        window.addEventListener('DOMContentLoaded', () => {
            loadTheme();
            loadCustomDomains();
            loadData();
            renderAllDomains();
            switchDomain('builders');
        });

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const btn = document.querySelector('.controls .btn');
            btn.textContent = newTheme === 'dark' ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
        }

        function loadTheme() {
            const theme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', theme);
            
            const btn = document.querySelector('.controls .btn');
            if (btn) {
                btn.textContent = theme === 'dark' ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
            }
        }

        // Load Custom Domains
        function loadCustomDomains() {
            const customDomains = JSON.parse(localStorage.getItem('customDomains') || '[]');
            const tabsContainer = document.getElementById('domainTabs');
            
            customDomains.forEach(domain => {
                domains.push({ id: domain.id, name: domain.name });
                
                const tab = document.createElement('button');
                tab.className = 'domain-tab';
                tab.textContent = domain.name;
                tab.onclick = () => switchDomain(domain.id);
                tabsContainer.appendChild(tab);
            });
        }

        // Switch Domain
        function switchDomain(domainId) {
            currentDomain = domainId;
            
            document.querySelectorAll('.domain-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            event.target.classList.add('active');
            
            document.querySelectorAll('.domain-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const content = document.getElementById(`${domainId}-content`);
            if (content) {
                content.classList.add('active');
            }
        }

        // Render All Domains
        function renderAllDomains() {
            const container = document.getElementById('domainContents');
            container.innerHTML = '';
            
            domains.forEach((domain, index) => {
                const domainContent = createDomainHTML(domain.id, domain.name, index === 0);
                container.appendChild(domainContent);
            });
            
            renderAll();
        }

        // Create Domain HTML
        function createDomainHTML(domainId, domainName, isActive) {
            const div = document.createElement('div');
            div.id = `${domainId}-content`;
            div.className = `domain-content ${isActive ? 'active' : ''}`;
            
            div.innerHTML = `
                <!-- Statistics Overview -->
                <div class="stats-overview">
                    <h2>${domainName} - Stakeholder Overview</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value stat-total" id="${domainId}-total">0</div>
                            <div class="stat-label">Total Stakeholders</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value stat-q1" id="${domainId}-formal-count">0</div>
                            <div class="stat-label">Formal Authority</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value stat-q2" id="${domainId}-informal-count">0</div>
                            <div class="stat-label">Informal Influence</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value stat-q3" id="${domainId}-resources-count">0</div>
                            <div class="stat-label">Resource Control</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value stat-q4" id="${domainId}-blockers-count">0</div>
                            <div class="stat-label">Potential Blockers</div>
                        </div>
                    </div>
                </div>

                <div class="power-interest-grid">
                    <!-- Formal Authority -->
                    <div class="quadrant">
                        <div class="quadrant-header">
                            <div class="quadrant-title">Formal Authority</div>
                            <div class="quadrant-badge formal-authority">Decision Makers</div>
                        </div>
                        <p class="quadrant-description">Who holds formal decision-making power?</p>
                        <div class="stakeholder-list" id="${domainId}-formal"></div>
                        <button class="add-stakeholder" onclick="addStakeholder('${domainId}', 'formal')">+ Add Stakeholder</button>
                    </div>

                    <!-- Informal Influence -->
                    <div class="quadrant">
                        <div class="quadrant-header">
                            <div class="quadrant-title">Informal Influence</div>
                            <div class="quadrant-badge informal-influence">Key Influencers</div>
                        </div>
                        <p class="quadrant-description">Who shapes opinions and builds consensus?</p>
                        <div class="stakeholder-list" id="${domainId}-informal"></div>
                        <button class="add-stakeholder" onclick="addStakeholder('${domainId}', 'informal')">+ Add Stakeholder</button>
                    </div>

                    <!-- Resource Control -->
                    <div class="quadrant">
                        <div class="quadrant-header">
                            <div class="quadrant-title">Resource Control</div>
                            <div class="quadrant-badge resource-control">Resource Holders</div>
                        </div>
                        <p class="quadrant-description">Who controls funding, space, networks?</p>
                        <div class="stakeholder-list" id="${domainId}-resources"></div>
                        <button class="add-stakeholder" onclick="addStakeholder('${domainId}', 'resources')">+ Add Stakeholder</button>
                    </div>

                    <!-- Potential Blockers -->
                    <div class="quadrant">
                        <div class="quadrant-header">
                            <div class="quadrant-title">Potential Blockers</div>
                            <div class="quadrant-badge blockers">Watch List</div>
                        </div>
                        <p class="quadrant-description">Who could block or slow progress?</p>
                        <div class="stakeholder-list" id="${domainId}-blockers"></div>
                        <button class="add-stakeholder" onclick="addStakeholder('${domainId}', 'blockers')">+ Add Stakeholder</button>
                    </div>
                </div>

                <!-- 30-60-90 Day Engagement Strategy -->
                <div class="strategy-section">
                    <h3>30-60-90 Day Engagement Strategy</h3>
                    <div class="timeline-grid">
                        <div class="timeline-column">
                            <div class="timeline-header">Days 1-30</div>
                            <div id="${domainId}-30day-actions"></div>
                            <button class="add-stakeholder" onclick="add30DayAction('${domainId}')">+ Add Action</button>
                        </div>
                        <div class="timeline-column">
                            <div class="timeline-header">Days 31-60</div>
                            <div id="${domainId}-60day-actions"></div>
                            <button class="add-stakeholder" onclick="add60DayAction('${domainId}')">+ Add Action</button>
                        </div>
                        <div class="timeline-column">
                            <div class="timeline-header">Days 61-90</div>
                            <div id="${domainId}-90day-actions"></div>
                            <button class="add-stakeholder" onclick="add90DayAction('${domainId}')">+ Add Action</button>
                        </div>
                    </div>
                </div>
            `;
            
            return div;
        }

        function addStakeholder(domainId, quadrant) {
            const name = prompt('Enter stakeholder name:');
            if (!name || name.trim() === '') return;
            counter++;
            
            if (!data[domainId]) {
                data[domainId] = { q1: [], q2: [], q3: [], q4: [] };
            }
            
            data[domainId][quadrant].push({
                id: `stakeholder-${counter}`,
                name,
                strategy: ''
            });
            
            renderDomain(domainId);
            save();
        }

        function deleteStakeholder(domainId, quadrant, id) {
            if (!confirm('Delete this stakeholder?')) return;
            data[domainId][quadrant] = data[domainId][quadrant].filter(s => s.id !== id);
            renderDomain(domainId);
            save();
        }

        function updateStakeholder(domainId, quadrant, id, field, value) {
            const stakeholder = data[domainId][quadrant].find(s => s.id === id);
            if (stakeholder) {
                stakeholder[field] = value;
                save();
            }
        }

        function renderDomain(domainId) {
            if (!data[domainId]) {
                data[domainId] = {
                    formal: [],
                    informal: [],
                    resources: [],
                    blockers: [],
                    day30: [],
                    day60: [],
                    day90: []
                };
            }
            
            const quadrants = ['formal', 'informal', 'resources', 'blockers'];
            let total = 0;
            
            quadrants.forEach(q => {
                const container = document.getElementById(`${domainId}-${q}`);
                if (container) {
                    container.innerHTML = data[domainId][q].map(s => `
                        <div class="stakeholder">
                            <input type="text" value="${s.name}" 
                                   onchange="updateStakeholder('${domainId}', '${q}', '${s.id}', 'name', this.value)" 
                                   placeholder="Name">
                            <textarea onchange="updateStakeholder('${domainId}', '${q}', '${s.id}', 'strategy', this.value)" 
                                      placeholder="Engagement strategy...">${s.strategy}</textarea>
                            <button style="margin-top:4px; padding:2px 8px; background:transparent; border:1px solid var(--border-color); border-radius:3px; font-size:9px; cursor:pointer;" 
                                    onclick="deleteStakeholder('${domainId}', '${q}', '${s.id}')">üóëÔ∏è</button>
                        </div>
                    `).join('');
                }
                
                // Update quadrant count
                const count = data[domainId][q].length;
                const countEl = document.getElementById(`${domainId}-${q}-count`);
                if (countEl) {
                    countEl.textContent = count;
                }
                
                total += count;
            });
            
            // Update total count
            const totalEl = document.getElementById(`${domainId}-total`);
            if (totalEl) {
                totalEl.textContent = total;
            }
            
            // Render 30-60-90 day actions
            renderTimeline(domainId, '30day', 'day30');
            renderTimeline(domainId, '60day', 'day60');
            renderTimeline(domainId, '90day', 'day90');
        }
        
        function renderTimeline(domainId, containerId, dataKey) {
            const container = document.getElementById(`${domainId}-${containerId}-actions`);
            if (!container) return;
            
            if (!data[domainId][dataKey]) {
                data[domainId][dataKey] = [];
            }
            
            container.innerHTML = data[domainId][dataKey].map(action => `
                <div class="action-item">
                    <input type="checkbox" ${action.completed ? 'checked' : ''} 
                           onchange="toggleAction('${domainId}', '${dataKey}', '${action.id}', this.checked)">
                    <textarea onchange="updateAction('${domainId}', '${dataKey}', '${action.id}', this.value)" 
                              placeholder="Action item...">${action.text}</textarea>
                    <button onclick="deleteAction('${domainId}', '${dataKey}', '${action.id}')">üóëÔ∏è</button>
                </div>
            `).join('');
        }

        function renderAll() {
            domains.forEach(domain => {
                renderDomain(domain.id);
            });
        }

        function save() {
            localStorage.setItem('stakeholder-map', JSON.stringify(data));
        }
        
        // 30-60-90 Day Actions
        function add30DayAction(domainId) {
            const text = prompt('Enter action for Days 1-30:');
            if (!text || text.trim() === '') return;
            counter++;
            
            if (!data[domainId].day30) data[domainId].day30 = [];
            data[domainId].day30.push({
                id: `action-${counter}`,
                text,
                completed: false
            });
            
            renderTimeline(domainId, '30day', 'day30');
            save();
        }
        
        function add60DayAction(domainId) {
            const text = prompt('Enter action for Days 31-60:');
            if (!text || text.trim() === '') return;
            counter++;
            
            if (!data[domainId].day60) data[domainId].day60 = [];
            data[domainId].day60.push({
                id: `action-${counter}`,
                text,
                completed: false
            });
            
            renderTimeline(domainId, '60day', 'day60');
            save();
        }
        
        function add90DayAction(domainId) {
            const text = prompt('Enter action for Days 61-90:');
            if (!text || text.trim() === '') return;
            counter++;
            
            if (!data[domainId].day90) data[domainId].day90 = [];
            data[domainId].day90.push({
                id: `action-${counter}`,
                text,
                completed: false
            });
            
            renderTimeline(domainId, '90day', 'day90');
            save();
        }
        
        function updateAction(domainId, dataKey, id, value) {
            const action = data[domainId][dataKey].find(a => a.id === id);
            if (action) {
                action.text = value;
                save();
            }
        }
        
        function toggleAction(domainId, dataKey, id, completed) {
            const action = data[domainId][dataKey].find(a => a.id === id);
            if (action) {
                action.completed = completed;
                save();
            }
        }
        
        function deleteAction(domainId, dataKey, id) {
            if (!confirm('Delete this action?')) return;
            data[domainId][dataKey] = data[domainId][dataKey].filter(a => a.id !== id);
            renderTimeline(domainId, dataKey.replace('day', '') + 'day', dataKey);
            save();
        }

        function loadData() {
            const saved = localStorage.getItem('stakeholder-map');
            if (saved) {
                data = JSON.parse(saved);
            } else {
                // Initialize data for all domains
                domains.forEach(domain => {
                    data[domain.id] = {
                        formal: [],
                        informal: [],
                        resources: [],
                        blockers: [],
                        day30: [],
                        day60: [],
                        day90: []
                    };
                });
            }
            
            // Ensure all domains have data structure
            domains.forEach(domain => {
                if (!data[domain.id]) {
                    data[domain.id] = {
                        formal: [],
                        informal: [],
                        resources: [],
                        blockers: [],
                        day30: [],
                        day60: [],
                        day90: []
                    };
                }
            });
        }

        function exportData() {
            const exportData = {
                timestamp: new Date().toISOString(),
                data: data
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `stakeholder-map-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
